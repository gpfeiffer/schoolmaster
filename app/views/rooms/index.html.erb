<h1>Postgraduate rooms</h1>

<table>
  <% @rooms.each do |room| %>
    <tr>
      <td><%= link_to room, room %></td>
      <td align="right"><%= room.capacity %> desks</td>
      <td align="right">(<%= room.students.count %> busy, <%= room.capacity - room.students.count %> free)</td>
  </tr>
  <% end %>
  <tr>
    <th>Total:</th>
    <td align="right"><%= @rooms.map{ |x| x.capacity || 0 }.sum %> desks</td>
    <td align="right"><%= @rooms.map{ |x| x.students.count }.sum %> busy</td>
  </tr>
</table>

<br />

<% if can? :create, Room %>
  <%= link_to 'New Room', new_room_path %>
<% end %>
